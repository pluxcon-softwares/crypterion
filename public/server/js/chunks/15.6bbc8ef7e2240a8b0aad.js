exports.ids=[15],exports.modules={ctCr:function(e,t,a){"use strict";var n=a("h0/l"),r=a.n(n),o=a("q1tI"),c=a.n(o),i=a("7++0");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":s(e)})(e)}function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function f(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,m(t).apply(this,arguments))}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){return c.a.createElement(r.a,u({title:c.a.createElement(i.a,{defaultMessage:"Are you sure?",id:"common.popconfirm_title"}),cancelText:c.a.createElement(i.a,{defaultMessage:"No",id:"common.no"}),okText:c.a.createElement(i.a,{defaultMessage:"Yes",id:"common.yes"})},this.props))}}])&&f(a.prototype,n),o&&f(a,o),t}(o.Component);t.a=h},hyda:function(e,t,a){"use strict";a.r(t);var n=a("Btem"),r=a.n(n),o=a("q1tI"),c=a.n(o),i=a("iNPk"),s=a("/MKj"),l=a("EC67"),u=a("vVgw"),f=a("4IMT"),p=a.n(f),m=a("7++0");function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e){return(h="function"==typeof Symbol&&"symbol"===d(Symbol.iterator)?function(e){return d(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":d(e)})(e)}function b(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return!t||"object"!==h(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),y(this,g(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props.onToggleDrawer;return c.a.createElement("div",{className:"cp-comment-box"},c.a.createElement("div",{className:"cp-fs-80"},c.a.createElement("i",{className:"la la-comments"})),c.a.createElement("h1",{className:"text-muted"},c.a.createElement(m.a,{defaultMessage:"Select Chat to Begin!",id:"chat.select_to_begin"})),c.a.createElement(p.a,{type:"primary",className:"d-block d-lg-none mt-3",onClick:e},c.a.createElement(m.a,{defaultMessage:"Show Chats",id:"chat.show_chats"})))}}])&&b(a.prototype,n),r&&b(a,r),t}(o.Component),w=a("tE8B"),S=a.n(w),O=a("MM9K"),_=a.n(O),j=a("iJl9"),k=a.n(j),M=a("Pbn2"),P=a.n(M),C=a("RWbP"),T=a.n(C),N=a("qPyV"),x=a.n(N),D=a("UfWW"),U=a.n(D),A=a("E+oP"),F=a.n(A),B=a("hqwM"),I=a.n(B),R=a("amnm"),L=a("J2m7"),W=a.n(L),z=a("pWf2"),V=a.n(z),K=a("DRDh"),q=a("Falu"),H=a("fVSG"),G=a("wUfQ");function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e){return(Y="function"==typeof Symbol&&"symbol"===Q(Symbol.iterator)?function(e){return Q(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Q(e)})(e)}function J(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var te=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=X(t).call(this,e),a=!r||"object"!==Y(r)&&"function"!=typeof r?Z(n):r,ee(Z(a),"chatParticipationChangedListener",(function(e){F()(e)||a.props.auth.user.id===e.user_id&&a.setState({participation:e})})),ee(Z(a),"chatUpdatedListener",(function(e){var t=a.api,n=t.axios,r=t.route;if(!F()(e.chat)){a.fetchParticipation();var o=r("chats.get",{chat:e.chat.id});n.post(o.url()).then((function(e){return Object(H.d)(e,(function(e){a.updateChat(e)}))})).catch((function(e){return Object(H.a)(e)}))}})),ee(Z(a),"getUserAvatar",(function(){var e=a.getHighlightedParticipant();return F()(e)?c.a.createElement(V.a,{icon:"message",size:50}):c.a.createElement(R.a,{user:e.user,size:50})})),ee(Z(a),"getMessageDetail",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;switch(e.type){case"activity":return a.getActivityDetail(e.activity,t);case"text":return a.getTextDetail(e.text,t);case"attachment":return a.getAttachmentDetail(e.attachment,t);default:return null}})),ee(Z(a),"getTextDetail",(function(e,t){return F()(e)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,Object(i.f)(e.body,t))})),ee(Z(a),"getAttachmentDetail",(function(e,t){return F()(e)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,c.a.createElement("i",{className:"la la-paperclip mr-1"}),c.a.createElement("span",null,Object(i.f)(e.name,t)))})),ee(Z(a),"getActivityDetail",(function(e,t){return e&&c.a.createElement("span",null,Object(i.f)(e.body,t))})),ee(Z(a),"handleClick",(function(){var e=a.props,t=e.onOpen,n=e.chat;if("function"==typeof t)return t(n)})),a.broadcast=new K.a,a.api=new q.a,a.state={participation:{}},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.bindBroadcastEvents(),this.fetchParticipation()}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("ChatParticipationChanged",this.chatParticipationChangedListener),this.broadcast.listen("ChatUpdated",this.chatUpdatedListener)}},{key:"updateChat",value:function(e){var t=this.props.onChatUpdated;if("function"==typeof t)return t(e)}},{key:"resetBroadcastChannel",value:function(){var e=this.props.chat;F()(e)?this.broadcast.unbind():this.broadcast.setChannel("App.Chat."+e.id)}},{key:"fetchParticipation",value:function(){var e=this,t=this.api,a=t.axios,n=(0,t.route)("chats.participation",{chat:this.props.chat.id});a.post(n.url()).then((function(t){return Object(H.d)(t,(function(t){e.setState({participation:t})}))})).catch((function(e){return Object(H.a)(e)}))}},{key:"componentDidUpdate",value:function(e,t,a){var n=e.chat,r=this.props.chat;n.id!==r.id&&(console.info("ChatCell Updated"),this.resetBroadcastChannel())}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"getTitle",value:function(){var e=this.props.chat,t=this.getHighlightedParticipant();if(F()(t))return c.a.createElement(m.a,{defaultMessage:"Conversation",id:"chats.conversation"});var a=t.user.name;return e.participants.length>1&&(a=c.a.createElement(m.a,{id:"chats.cell_title",defaultMessage:"{user} and {total} other(s)",values:{total:e.participants.length-1,user:t.user.name}})),c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium"},a))}},{key:"getUser",value:function(e){var t=this.props,a=t.chat,n=t.auth,r=a.participants;if(n.user.id===e)return n.user;var o=W()(r,(function(t){return!F()(t.user)&&t.user.id===e}));return F()(o)?o:o.user}},{key:"getLastMessage",value:function(){var e=this.props,t=e.chat,a=e.auth,n=t.latest_message,r=t.participants;if(F()(n))return null;var o=n.user;return F()(o)?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},c.a.createElement(m.a,{defaultMessage:"Unknown User",id:"common.unknown_user"}),":"),this.getMessageDetail(n,20)):o.id===a.user.id?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},c.a.createElement(m.a,{defaultMessage:"Me",id:"common.me"}),":"),this.getMessageDetail(n,23)):r.length>1?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"font-weight-medium mr-1"},o.name,":"),this.getMessageDetail(n,20)):this.getMessageDetail(n,25)}},{key:"getHighlightedParticipant",value:function(){if(F()(this.highlightedParticpant)){var e=this.props,t=e.chat,a=e.auth,n=t.participants;this.highlightedParticpant=W()(n,(function(e){return!F()(e.user)&&e.user.id!==a.user.id}))}return this.highlightedParticpant}},{key:"getTime",value:function(){var e=this.props.chat.latest_message;return F()(e)?null:Object(i.g)(e.created_at)}},{key:"getUnreadCount",value:function(){var e=this.state.participation;if(this.props.active||F()(e))return null;var t=e.unread_messages_count;return!t||t<=0?null:Object(G.a)(t)}},{key:"render",value:function(){var e=this.getUnreadCount(),t=this.props.active,a="cp-chat-user-item ".concat(t&&"active");return c.a.createElement("div",{className:a,onClick:this.handleClick},c.a.createElement("div",{className:"cp-chat-user-row"},c.a.createElement("div",{className:"cp-chat-avatar"},this.getUserAvatar()),c.a.createElement("div",{className:"cp-chat-info"},c.a.createElement("span",{className:"cp-chat-name h4"},this.getTitle()),c.a.createElement("div",{className:"cp-chat-desc"},this.getLastMessage()),c.a.createElement("div",{className:"cp-chat-time"},this.getTime())),c.a.createElement("div",{className:"cp-chat-date"},e&&c.a.createElement("div",{className:"badge"},e))))}}])&&J(a.prototype,n),r&&J(a,r),t}(o.Component),ae=a("RotF"),ne=a.n(ae),re=a("mP/V"),oe=a("v1ta"),ce=a("pvl8"),ie=a("VWBV");function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e){return(le="function"==typeof Symbol&&"symbol"===se(Symbol.iterator)?function(e){return se(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":se(e)})(e)}function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function fe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(a,!0).forEach((function(t){ye(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function pe(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function me(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function de(e){return(de=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ge=I.a.Item,ve=Object(m.c)({searchUsers:{id:"chats.input_filter_by_contact_name_placeholder",defaultMessage:"Filter by contact name..."}}),Ee=function(e){function t(e){var a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=de(t).call(this,e),a=!r||"object"!==le(r)&&"function"!=typeof r?he(n):r,ye(he(a),"chatParticipantCreatedListener",(function(e){var t=a.api,n=t.axios,r=t.route;if(!F()(e.participant)){var o=r("chats.get",{chat:e.participant.chat_id});n.post(o.url()).then((function(e){return Object(H.d)(e,(function(e){a.setState((function(t){var n=t.data.concat(e);return{data:a.sortChats(n)}}))}))})).catch((function(e){return Object(H.a)(e)}))}})),ye(he(a),"onChatUpdated",(function(e){var t=a.state.data,n=U()(t,(function(t){return t.id===e.id})),r=pe(t);n<0?r=r.concat(e):r[n]=e,r=a.sortChats(r),a.setState({data:r})})),ye(he(a),"sortChats",(function(e){return Array.isArray(e)?(e=e.sort((function(e,t){return Object(i.d)(t.updated_at,e.updated_at)})),x()(e,"id")):e})),ye(he(a),"fetchChats",(function(){var e=a.state,t=e.params,n=e.filters,r=fe({},t,{current:1});a.pagination.fetchData(r,n,(function(e){a.setState((function(){return{params:fe({},r,{total:e.meta.total}),data:e.data,loading:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loading:!1})})),a.setState({loading:!0})})),ye(he(a),"onChangeUserSearch",(function(e){var t=e.target.value;clearTimeout(a.searching);var n=a.state.filters;a.canSearchUser()&&(a.setState({filters:fe({},n,{user:t})}),a.searching=setTimeout(a.fetchChats,2e3))})),ye(he(a),"onSearchKeyUp",(function(e){"Enter"===e.key&&(clearTimeout(a.searching),a.fetchChats())})),ye(he(a),"onLoadMore",(function(e){if(a.canLoadMore()){var t=a.state,n=t.params,r=t.filters,o=fe({},n,{current:n.current+1});a.pagination.fetchData(o,r,(function(e){a.setState((function(t){var n=t.data.concat(e.data);return{data:a.sortChats(n),params:fe({},o,{total:e.meta.total}),loadingMore:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loadingMore:!1})})),a.setState({loadingMore:!0})}})),ye(he(a),"handleChatOpen",(function(e){var t=a.props.history,n=Object(l.g)(ie.a["chat.view"].path,{token:e.id});if(!F()(t))return t.replace(n)})),ye(he(a),"setScrollWrapper",(function(e){if(e!==a.scrollWrapper&&null!==e){var t=new ce.a(e);a.scrollParent=t.getScrollElement(),a.scrollWrapper=e}})),a.broadcast=new K.a,a.api=new q.a,a.state={data:[],hasMore:!1,params:{total:0,pageSize:20,current:1},filters:{user:""},loadingMore:!1,loading:!1};var o=a.api.route("chats.table").url();return a.pagination=new re.a(a.api,o),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.bindBroadcastEvents(),this.fetchChats()}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("ChatParticipantCreated",this.chatParticipantCreatedListener)}},{key:"resetBroadcastChannel",value:function(){var e=this.props.auth;e.check()?this.broadcast.setChannel("Auth.User."+e.user.id):this.broadcast.unbind()}},{key:"componentDidUpdate",value:function(e,t,a){var n=e.auth.user,r=this.props.auth.user;n.id!==r.id&&(console.info("Menu Updated"),this.resetBroadcastChannel())}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"canSearchUser",value:function(){var e=this.state,t=e.loading,a=e.loadingMore;return!(t||a)}},{key:"canLoadMore",value:function(){var e=this.state,t=e.hasMore,a=e.loadingMore,n=e.loading;return t&&!a&&!n}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.loadingMore,r=t.hasMore,o=t.filters,i=t.data,s=this.props,l=s.intl,u=s.auth,f=s.activeChat,p=u.user.marketplace_stats.total_active_trades;return c.a.createElement("div",{className:"cp-chat-sidenav-main"},c.a.createElement("div",{className:"cp-chat-sidenav-header"},c.a.createElement("div",{className:"cp-chat-user-hd"},c.a.createElement("div",{className:"cp-chat-avatar mr-3"},c.a.createElement(R.a,{user:u.user,showPresence:!1,size:50})),c.a.createElement("div",{className:"cp-module-user-info flex-column justify-content-center"},c.a.createElement("div",{className:"cp-module-title"},c.a.createElement("h5",{className:"mb-0"},c.a.createElement(m.a,{defaultMessage:"Conversations",id:"chats.conversations"}))),c.a.createElement("div",{className:"cp-module-user-detail"},c.a.createElement("div",{className:"cp-text-grey d-flex my-1 align-items-center"},p>0&&c.a.createElement(T.a,{count:p,style:{backgroundColor:"#2db7f5"},className:"mb-0 mr-2"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Active Trades",id:"common.active_trades"})))))),c.a.createElement("div",{className:"cp-chat-search-wrapper"},c.a.createElement(k.a,{suffix:c.a.createElement(P.a,{type:"search"}),placeholder:l.formatMessage(ve.searchUsers),size:"large",onKeyUp:this.onSearchKeyUp,disabled:!this.canSearchUser(),onChange:this.onChangeUserSearch,value:o.user}))),c.a.createElement("div",{className:"cp-chat-sidenav-content"},c.a.createElement(_.a,{spinning:a},c.a.createElement("div",{ref:this.setScrollWrapper,className:"cp-chat-sidenav-scroll","data-simplebar":!0},c.a.createElement(ne.a,{useWindow:!1,getScrollParent:function(){return e.scrollParent},loadMore:this.onLoadMore,pageStart:1,hasMore:!n&&r,initialLoad:!1},c.a.createElement("div",{className:"cp-chat-user"},c.a.createElement(I.a,{dataSource:i,rowKey:function(e){return e.id},renderItem:function(t){return c.a.createElement(ge,{className:"p-0"},c.a.createElement(te,{onChatUpdated:e.onChatUpdated,active:f&&f.token===t.id,auth:u,chat:t,onOpen:e.handleChatOpen}))}})),n&&c.a.createElement(oe.a,null))))))}}])&&me(a.prototype,n),r&&me(a,r),t}(o.Component),we=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),m.d,l.i)(Ee),Se=a("9xET"),Oe=a.n(Se),_e=a("B8+X"),je=a.n(_e),ke=a("ZPTe"),Me=a.n(ke),Pe=a("QpBz"),Ce=a.n(Pe),Te=a("OFL0"),Ne=a.n(Te),xe=a("hw8t"),De=a.n(xe);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e){return(Ae="function"==typeof Symbol&&"symbol"===Ue(Symbol.iterator)?function(e){return Ue(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ue(e)})(e)}function Fe(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Be(e,t){return!t||"object"!==Ae(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Be(this,Ie(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props.onToggleDrawer;return c.a.createElement("div",{className:"d-flex align-items-center w-100"},c.a.createElement("div",{className:"text-center w-100"},c.a.createElement(De.a,{title:c.a.createElement(m.a,{defaultMessage:"Chat could not be found.",id:"chats.chat_not_found_title"}),extra:c.a.createElement(p.a,{type:"primary",className:"d-inline-block d-lg-none mt-3",onClick:e},c.a.createElement(m.a,{defaultMessage:"Show Chats",id:"chat.show_chats"})),subTitle:c.a.createElement(m.a,{defaultMessage:"Please, select a new chat to display!",id:"chats.chat_not_found_sub_title"}),status:"404"})))}}])&&Fe(a.prototype,n),r&&Fe(a,r),t}(o.Component),We=a("55Ip");function ze(e){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"===ze(Symbol.iterator)?function(e){return ze(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ze(e)})(e)}function Ke(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ye=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return n=this,r=(e=qe(t)).call.apply(e,[this].concat(s)),a=!r||"object"!==Ve(r)&&"function"!=typeof r?He(n):r,Qe(He(a),"getUserAvatar",(function(){var e=a.props.message.user;return c.a.createElement(We.a,{to:"/profile/".concat(e.name)},c.a.createElement(R.a,{className:"align-self-end",user:e,size:40}))})),Qe(He(a),"getTextDetail",(function(){var e=a.props.message;return F()(e.text)?c.a.createElement("span",null,c.a.createElement("i",{className:"la la-ban mr-1"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Message Deleted",id:"chats.message_deleted"}))):c.a.createElement("span",null,e.text.body)})),Qe(He(a),"getTimestamp",(function(){var e=a.props.message;return e.created_at&&c.a.createElement("small",{className:"text-muted"},Object(i.g)(e.created_at))})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e="right"===this.props.mode?"cp-chat-item flex-row-reverse":"cp-chat-item";return c.a.createElement("div",{className:e},this.getUserAvatar(),c.a.createElement("div",{className:"cp-bubble-block"},c.a.createElement("div",{className:"cp-bubble d-inline-block"},c.a.createElement("div",{className:"cp-message mb-2"},this.getTextDetail()),c.a.createElement("div",{className:"cp-time text-right"},this.getTimestamp()))))}}])&&Ke(a.prototype,n),r&&Ke(a,r),t}(o.Component),Je=a("UIqZ"),Xe=a.n(Je);function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e){return($e="function"==typeof Symbol&&"symbol"===Ze(Symbol.iterator)?function(e){return Ze(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Ze(e)})(e)}function et(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t){return(nt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tt(this,at(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nt(e,t)}(t,e),a=t,(n=[{key:"getTimestamp",value:function(){var e=this.props.message;return c.a.createElement("span",{className:"font-weight-semi-bold"},Object(i.g)(e.created_at))}},{key:"getUserName",value:function(){var e=this.props.message;return F()(e.user)?c.a.createElement(m.a,{defaultMessage:"Unknown User",id:"common.unknown_user"}):c.a.createElement("span",{className:"font-weight-medium"},e.user.name,":")}},{key:"render",value:function(){var e=this.props.message.activity;return F()(e)||!e.body?c.a.createElement(I.a.Item,null):c.a.createElement(Xe.a,{className:"font-weight-normal",dashed:!0},c.a.createElement("small",null,c.a.createElement(m.a,{id:"chat.activity_body",defaultMessage:"{user} {body} {time}",values:{time:this.getTimestamp(),body:e.body,user:this.getUserName()}})))}}])&&et(a.prototype,n),r&&et(a,r),t}(o.Component);function ot(e){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ct(e){return(ct="function"==typeof Symbol&&"symbol"===ot(Symbol.iterator)?function(e){return ot(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":ot(e)})(e)}function it(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ft(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var pt=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return n=this,r=(e=st(t)).call.apply(e,[this].concat(i)),a=!r||"object"!==ct(r)&&"function"!=typeof r?lt(n):r,ft(lt(a),"getUserAvatar",(function(){var e=a.props.message.user;return c.a.createElement(We.a,{to:"/profile/".concat(e.name)},c.a.createElement(R.a,{className:"align-self-end",user:e,size:40}))})),ft(lt(a),"isImageType",(function(e){return"image/jpeg"===e||"image/png"===e})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(t,e),a=t,(n=[{key:"getAttachmentDetail",value:function(){var e=this.props.message.attachment,t=e.url;return F()(e)?c.a.createElement("div",{className:"cp-attachment d-flex"},c.a.createElement("i",{className:"la la-ban cp-fs-lg mr-2"}),c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Attachment Deleted",id:"chats.attachment_deleted"}))):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"cp-attachment d-flex"},c.a.createElement("span",{className:"mr-2"},c.a.createElement("i",{className:"la la-paperclip cp-fs-lg"})),c.a.createElement("span",{className:"mr-2 fs-sm"},Object(i.f)(e.name,20)),c.a.createElement(p.a,{className:"ml-0 mb-0",type:"dashed",shape:"circle",href:t,icon:"download"})))}},{key:"getTimestamp",value:function(){var e=this.props.message;return c.a.createElement("small",{className:"text-muted"},Object(i.g)(e.created_at))}},{key:"render",value:function(){var e="right"===this.props.mode?"cp-chat-item flex-row-reverse":"cp-chat-item";return c.a.createElement("div",{className:e},this.getUserAvatar(),c.a.createElement("div",{className:"cp-bubble-block"},c.a.createElement("div",{className:"cp-bubble d-inline-block"},c.a.createElement("div",{className:"cp-message mb-2"},this.getAttachmentDetail()),c.a.createElement("div",{className:"cp-time text-right"},this.getTimestamp()))))}}])&&it(a.prototype,n),r&&it(a,r),t}(o.Component),mt=a("aOJk"),dt=a.n(mt),ht=a("EQeY"),bt=a.n(ht),yt=a("gQMU"),gt=a.n(yt),vt=a("CC+v"),Et=a.n(vt),wt=a("lB7Y"),St=a.n(wt),Ot=a("N9UN"),_t=a.n(Ot);function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e){return(kt="function"==typeof Symbol&&"symbol"===jt(Symbol.iterator)?function(e){return jt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":jt(e)})(e)}function Mt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pt(this,Ct(t).apply(this,arguments))}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.styleName,a=e.name,n=e.price;return c.a.createElement(_t.a,{className:"".concat(t," cp-card-price mb-0")},c.a.createElement("h6",{className:"text-muted"},a),c.a.createElement("h4",{className:"font-weight-medium"},n))}}])&&Mt(a.prototype,n),r&&Mt(a,r),t}(o.Component),xt=a("wd/R"),Dt=a.n(xt),Ut=a("ctCr"),At=a("qu0K"),Ft=a.n(At),Bt=a("4ztd");function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rt(e){return(Rt="function"==typeof Symbol&&"symbol"===It(Symbol.iterator)?function(e){return It(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":It(e)})(e)}function Lt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vt(e,t){return(Vt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var qt=Object(m.c)({twoFactorCode:{id:"marketplace.input_two_factor_code_placeholder",defaultMessage:"Enter your Two Factor code."},password:{id:"marketplace.input_password_placeholder",defaultMessage:"Enter your Password."}}),Ht=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var o=arguments.length,c=new Array(o),i=0;i<o;i++)c[i]=arguments[i];return n=this,r=(e=Wt(t)).call.apply(e,[this].concat(c)),a=!r||"object"!==Rt(r)&&"function"!=typeof r?zt(n):r,Kt(zt(a),"cancel",(function(){var e=a.props.onCancel;if("function"==typeof e)return e()})),Kt(zt(a),"submit",(function(){var e=a.props,t=e.form,n=e.onSubmit;t.validateFields((function(e,t){if(F()(e)&&"function"==typeof n)return n(t.code)}))})),a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vt(e,t)}(t,e),a=t,(n=[{key:"render",value:function(){var e=this.props,t=e.withTwoFactor,a=e.intl,n=this.props.form.getFieldDecorator;return c.a.createElement("div",{className:"p-2 text-left"},c.a.createElement(Ft.a,null,t?c.a.createElement(Ft.a.Item,{labelAlign:"left",label:c.a.createElement(m.a,{defaultMessage:"Token",id:"marketplace.token"})},n("code",{rules:[{required:!0}]})(c.a.createElement(k.a,{placeholder:a.formatMessage(qt.twoFactorCode)}))):c.a.createElement(Ft.a.Item,{labelAlign:"left",label:c.a.createElement(m.a,{defaultMessage:"Password",id:"marketplace.password"})},n("code",{rules:[{required:!0}]})(c.a.createElement(k.a.Password,{placeholder:a.formatMessage(qt.password)}))),c.a.createElement(Ft.a.Item,{className:"mt-2"},c.a.createElement(p.a,{type:"primary",block:!0,onClick:this.submit,className:"mb-0"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Approve Trade",id:"marketplace.approve_trade"}))),c.a.createElement(p.a,{type:"dashed",block:!0,onClick:this.cancel},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Cancel",id:"marketplace.cancel"}))))))}}])&&Lt(a.prototype,n),r&&Lt(a,r),t}(o.Component),Gt=Object(i.c)(Object(Bt.a)())(Ht);function Qt(e){return(Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e){return(Yt="function"==typeof Symbol&&"symbol"===Qt(Symbol.iterator)?function(e){return Qt(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Qt(e)})(e)}function Jt(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ea(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ta=St.a.Countdown,aa=Object(m.c)({approved:{id:"chats.marketplace_approved_successful",defaultMessage:"Trade has been approved."},disputed:{id:"chats.marketplace_disputed_successful",defaultMessage:"A moderator will be in touch soon."},cancelled:{id:"chats.marketplace_cancelled_successful",defaultMessage:"Trade has been cancelled."},confirmed:{id:"chats.marketplace_confirmed_successful",defaultMessage:"Trade has been marked as paid."}}),na=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Xt(t).call(this,e),a=!r||"object"!==Yt(r)&&"function"!=typeof r?Zt(n):r,ea(Zt(a),"onFinishCountDown",(function(){a.update()})),ea(Zt(a),"showInstructions",(function(e){Et.a.info({content:c.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.instructions)})})),ea(Zt(a),"showTerms",(function(e){Et.a.info({content:c.a.createElement("p",{style:{whiteSpace:"pre-line"}},e.terms)})})),ea(Zt(a),"update",(function(){var e=a.props.onUpdate;if("function"==typeof e)return e()})),ea(Zt(a),"canApproveTrade",(function(e){var t=a.props.auth;return!!e.confirmed_at&&(a.isOnGoing(e)&&(t.user.id===e.seller.id||a.userCanManageTrade(e)))})),ea(Zt(a),"approve",(function(e,t){var n=a.api,r=n.axios,o=n.route,c=a.props.intl,i=o("chats.marketplace.approve",{trade:e.id});a.setState({loading:!0}),r.post(i.url(),{code:t}).then((function(e){return Object(H.d)(e,(function(){a.setState({loading:!1}),a.update(),a.toggleVerificationForm()}),c.formatMessage(aa.approved))})).catch((function(e){return Object(H.a)(e,(function(){a.setState({loading:!1})}))}))})),ea(Zt(a),"isOnGoing",(function(e){return!F()(e)&&("active"===e.status||"dispute"===e.status)})),ea(Zt(a),"canConfirmTrade",(function(e){var t=a.props.auth,n=Dt.a.utc(e.cancels_at);return!e.confirmed_at&&(!Dt()().isAfter(n.local())&&("active"===e.status&&t.user.id===e.buyer_id))})),ea(Zt(a),"confirm",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.confirm",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(H.d)(e,(function(){a.setState({loading:!1}),a.update()}),o.formatMessage(aa.confirmed))})).catch((function(e){return Object(H.a)(e,(function(){a.setState({loading:!1})}))}))})),ea(Zt(a),"canCancelTrade",(function(e){var t=a.props.auth;return a.isOnGoing(e)&&(a.userCanManageTrade(e)||t.user.id===e.buyer_id)})),ea(Zt(a),"cancel",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.cancel",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(H.d)(e,(function(e){a.setState({loading:!1}),a.update()}),o.formatMessage(aa.cancelled))})).catch((function(e){return Object(H.a)(e,(function(){a.setState({loading:!1})}))}))})),ea(Zt(a),"canDisputeTrade",(function(e){if(!e.confirmed_at)return!1;if("active"!==e.status)return!1;var t=Dt.a.utc(e.confirmed_at),n=Dt.a.utc(e.created_at),r=Dt.a.utc(e.cancels_at).diff(n);return Dt()().diff(t.local())>r&&a.userIsPartOfTrade(e)})),ea(Zt(a),"dispute",(function(e){var t=a.api,n=t.axios,r=t.route,o=a.props.intl,c=r("chats.marketplace.dispute",{trade:e.id});a.setState({loading:!0}),n.post(c.url()).then((function(e){return Object(H.d)(e,(function(e){a.setState({loading:!1}),a.update()}),o.formatMessage(aa.disputed))})).catch((function(e){return Object(H.a)(e,(function(){a.setState({loading:!1})}))}))})),ea(Zt(a),"getStatusColor",(function(e){switch(e){case"successful":return"#52c41a";case"active":return"#2db7f5";case"dispute":return"#faad14";case"cancelled":return"#f5222d";default:return null}})),ea(Zt(a),"toggleVerificationForm",(function(){a.setState((function(e){return{showVerificationForm:!e.showVerificationForm}}))})),a.api=new q.a,a.state={showVerificationForm:!1,loading:!1},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,e),a=t,(n=[{key:"userCanManageTrade",value:function(e){return this.props.auth.can("manage_marketplace")&&!this.userIsPartOfTrade(e)}},{key:"userIsPartOfTrade",value:function(e){var t=this.props.auth;return t.user.id===e.seller_id||t.user.id===e.buyer_id}},{key:"componentWillUnmount",value:function(){this.api.cancel()}},{key:"render",value:function(){var e=this,t=this.props,a=t.trade,n=t.auth;if(F()(a)||!this.isOnGoing(a))return null;var r=this.state,o=r.loading,i=r.showVerificationForm,s=n.twoFactorSetting();return c.a.createElement(_.a,{spinning:o},c.a.createElement("div",{className:"cp-trade pt-3",key:a.id},c.a.createElement("h3",{className:"text-center"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"Trade Status",id:"chats.trade_status"})),c.a.createElement("span",null,c.a.createElement(bt.a,{color:this.getStatusColor(a.status)},gt()(a.status)))),c.a.createElement(Xe.a,null),c.a.createElement("div",{className:"px-1"},c.a.createElement(Oe.a,{gutter:8},c.a.createElement(Me.a,{span:12},c.a.createElement(Nt,{price:a.formatted_amount_price,styleName:"mb-3",name:c.a.createElement(m.a,{defaultMessage:"Amount",id:"common.amount"})})),c.a.createElement(Me.a,{span:12},c.a.createElement(Nt,{price:a.formatted_rate,styleName:"mb-3",name:c.a.createElement(m.a,{defaultMessage:"Rate",id:"common.rate"})}))),c.a.createElement(Oe.a,{gutter:8},c.a.createElement(Me.a,{span:12},c.a.createElement(Nt,{price:a.coin_name,name:c.a.createElement(m.a,{defaultMessage:"Coin",id:"common.coin"})})),c.a.createElement(Me.a,{span:12},c.a.createElement(Nt,{price:a.formatted_fee_price,name:c.a.createElement(m.a,{defaultMessage:"Fee",id:"common.fee"})})))),!a.confirmed_at&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Xe.a,null),c.a.createElement("div",{className:"text-center"},c.a.createElement(ta,{onFinish:this.onFinishCountDown,value:Dt.a.utc(a.cancels_at).local(),title:c.a.createElement(m.a,{defaultMessage:"Payment Deadline",id:"common.payment_deadline"})})),c.a.createElement(Xe.a,null)),c.a.createElement("div",{className:"my-3 text-center w-100"},this.canApproveTrade(a)&&c.a.createElement("div",null,i?c.a.createElement(Gt,{onSubmit:function(t){return e.approve(a,t)},onCancel:this.toggleVerificationForm,withTwoFactor:s.marketplace()}):c.a.createElement(p.a,{type:"default",shape:"round",onClick:this.toggleVerificationForm,className:"mx-0 mb-2 cp-btn-success",icon:"check-circle",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Release Coin",id:"trade.release_coin"})))),this.canConfirmTrade(a)&&c.a.createElement("div",null,c.a.createElement(Ut.a,{onConfirm:function(){return e.confirm(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"trade.mark_trade_as_paid_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Mark Trade as Paid",id:"trade.mark_trade_as_paid"}))}})},c.a.createElement(p.a,{type:"default",icon:"check",size:"small",className:"mx-0 mb-2",shape:"round"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Mark Trade as Paid",id:"trade.mark_trade_as_paid"}))))),this.canCancelTrade(a)&&c.a.createElement("div",null,c.a.createElement(Ut.a,{onConfirm:function(){return e.cancel(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"offer.cancel_trade_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Cancel Trade",id:"trade.cancel_trade"}))}})},c.a.createElement(p.a,{type:"default",shape:"round",className:"cp-btn-danger mx-0 mb-2",icon:"close-circle",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Cancel Trade",id:"trade.cancel_trade"}))))),this.canDisputeTrade(a)&&c.a.createElement("div",null,c.a.createElement(Ut.a,{onConfirm:function(){return e.dispute(a)},title:c.a.createElement(m.a,{defaultMessage:"Are you sure you want to {action}?",id:"offer.raise_dispute_confirmation",values:{action:c.a.createElement("b",null,c.a.createElement(m.a,{defaultMessage:"Raise Dispute",id:"trade.raise_dispute"}))}})},c.a.createElement(p.a,{type:"default",shape:"round",className:"cp-btn-warning mx-0 mb-2",icon:"flag",size:"small"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Raise Dispute",id:"trade.raise_dispute"})))))),c.a.createElement(Xe.a,null),c.a.createElement("div",{className:"px-2 mb-3 text-center"},c.a.createElement("h5",{className:"mb-2"},c.a.createElement("a",{className:"mr-2",onClick:function(){return e.showTerms(a)}},c.a.createElement(m.a,{defaultMessage:"Terms",id:"common.terms"})),c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"and",id:"common.and"})),c.a.createElement("a",{className:"mr-2",onClick:function(){return e.showInstructions(a)}},c.a.createElement(m.a,{defaultMessage:"Instructions",id:"common.instruction"}))),c.a.createElement("h5",{className:"mb-2"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"{buyer} to pay {offerAmount} to {seller}",values:{seller:c.a.createElement("b",null,a.seller.name),offerAmount:c.a.createElement("b",null,a.formatted_offer_amount),buyer:c.a.createElement("b",null,a.buyer.name)},id:"chats.trade_payment_instruction"}))),c.a.createElement("h5",null,c.a.createElement("span",{className:"mr-2"},a.payment_method_name),a.payment_method_description&&c.a.createElement(dt.a,{overlayStyle:{maxWidth:250},content:a.payment_method_description,title:c.a.createElement(m.a,{id:"common.payment_method_description",defaultMessage:"Description"}),trigger:"click"},c.a.createElement(P.a,{type:"question-circle",theme:"filled"})))),c.a.createElement(Xe.a,null)))}}])&&Jt(a.prototype,n),r&&Jt(a,r),t}(o.Component),ra=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),m.d)(na),oa=a("IztG"),ca=a.n(oa),ia=a("fTA7"),sa=a.n(ia);function la(e){return(la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e){return(ua="function"==typeof Symbol&&"symbol"===la(Symbol.iterator)?function(e){return la(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":la(e)})(e)}function fa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pa(e){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ma(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function da(e,t){return(da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ha=k.a.TextArea,ba=Object(m.c)({successful:{id:"admin.review_submitted_successful",defaultMessage:"You review has been submitted."},review:{id:"admin.textarea_review_placeholder",defaultMessage:"Write a review..."}}),ya=function(e){function t(e){var a,n,r,o,c,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=pa(t).call(this,e),a=!r||"object"!==ua(r)&&"function"!=typeof r?ma(n):r,o=ma(a),i=function(e){e.preventDefault();var t=a.props,n=t.form,r=t.intl,o=t.trade,c=a.api,i=c.axios,s=(0,c.route)("chats.marketplace.submit-review",{trade:o.id});n.validateFields((function(e,t){F()(e)&&(i.post(s.url(),t).then((function(e){return Object(H.c)(e,n,(function(){a.setState({loading:!1,submitted:!0})}),r.formatMessage(ba.successful))})).catch((function(e){return Object(H.b)(e,n,t,(function(){a.setState({loading:!1})}))})),a.setState({loading:!0}))}))},(c="handleSubmit")in o?Object.defineProperty(o,c,{value:i,enumerable:!0,configurable:!0,writable:!0}):o[c]=i,a.api=new q.a,a.state={submitted:!1,loading:!1},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&da(e,t)}(t,e),a=t,(n=[{key:"canSubmitReview",value:function(){var e=this.props,t=e.trade,a=e.auth,n=this.state.submitted;return"successful"===t.status&&(t.buyer_id===a.user.id?t.seller_rateable&&!n:t.seller_id===a.user.id&&t.buyer_rateable&&!n)}},{key:"componentWillUnmount",value:function(){this.api.cancel()}},{key:"render",value:function(){if(!this.canSubmitReview())return null;var e=this.props,t=e.intl,a=e.form.getFieldDecorator,n=this.state.loading;return c.a.createElement("div",{className:"px-3"},c.a.createElement(ca.a,{content:c.a.createElement(Ft.a,{onSubmit:this.handleSubmit},c.a.createElement(Ft.a.Item,null,a("comment",{rules:[{type:"string",required:!0,min:3,max:200}]})(c.a.createElement(ha,{style:{resize:"none"},placeholder:t.formatMessage(ba.review),rows:3}))),c.a.createElement(Ft.a.Item,{className:"d-flex align-items-center"},c.a.createElement("span",{className:"mr-2"},c.a.createElement(m.a,{defaultMessage:"Rate",id:"common.rate"}),":"),a("rating",{rules:[{type:"number",required:!0,min:1,max:5}]})(c.a.createElement(sa.a,null))),c.a.createElement(Ft.a.Item,null,c.a.createElement(p.a,{htmlType:"submit",loading:n,className:"mb-0",shape:"round",type:"primary"},c.a.createElement("span",null,c.a.createElement(m.a,{defaultMessage:"Submit Review",id:"marketplace.submit_review"})))))}))}}])&&fa(a.prototype,n),r&&fa(a,r),t}(o.Component),ga=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),Object(Bt.a)())(ya);function va(e){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ea(e){return(Ea="function"==typeof Symbol&&"symbol"===va(Symbol.iterator)?function(e){return va(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":va(e)})(e)}function wa(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Sa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wa(a,!0).forEach((function(t){Ma(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wa(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Oa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _a(e){return(_a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ja(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ka(e,t){return(ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ma(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Pa=k.a.TextArea,Ca=Object(m.c)({inputMessage:{id:"chats.input_message_placeholder",defaultMessage:"Type a message..."}}),Ta=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=_a(t).call(this,e),a=!r||"object"!==Ea(r)&&"function"!=typeof r?ja(n):r,Ma(ja(a),"marketplaceTradeSavedListener",(function(e){a.fetchMarketplaceTrade()})),Ma(ja(a),"newChatMessageListener",(function(e){var t=a.props.auth;if(!F()(e.message)){var n=e.message;n.user_id!==t.user.id&&a.updateParticipation(n.chat_id),a.setState((function(e){var t=e.data;return{data:a.sortMessages(t.concat(n))}}),(function(){a.scrollToBottom()}))}})),Ma(ja(a),"onMarketplaceTradeUpdate",(function(){a.toggleMarketplaceTradeDrawer(),a.fetchMarketplaceTrade()})),Ma(ja(a),"updateParticipation",(function(e){var t=a.api,n=t.axios,r=t.route;if(e){var o=r("chats.update-participation",{chat:e});n.post(o.url()).then((function(e){return Object(H.d)(e)})).catch((function(e){return Object(H.a)(e)}))}})),Ma(ja(a),"sendText",(function(){var e=a.state,t=e.chat,n=e.text;if(n&&a.canSendMessage()){var r=a.api,o=r.axios,c=(0,r.route)("chats.messages.save-text",{chat:t.id});o.post(c.url(),{body:n}).then((function(e){return Object(H.d)(e,(function(){a.setState({sendingText:!1})}))})).catch((function(e){return Object(H.a)(e,(function(){a.setState({sendingText:!1})}))})),a.setState({sendingText:!0,text:""},(function(){a.scrollToBottom()}))}})),Ma(ja(a),"beforeUpload",(function(e){var t=a.canSendMessage();return a.setState({sendingAttachment:t},(function(){t&&a.scrollToBottom()})),t})),Ma(ja(a),"handleUploadSuccess",(function(e){a.setState((function(t){var n=t.data;return{sendingAttachment:!1,data:a.sortMessages(n.concat(e))}}),(function(){a.scrollToBottom()}))})),Ma(ja(a),"handleUploadError",(function(e){Ne()(e,"file")&&e.file.forEach((function(e){return Ce.a.error(e)}))})),Ma(ja(a),"fetchMessages",(function(){var e=a.state,t=e.filters,n=e.chat,r=Sa({},e.params,{current:1});if(!F()(n)&&n.id){var o=a.api.route("chats.messages.table",{chat:n.id}).url();a.mesagePagination=new re.a(a.api,o),a.setState({loading:!0,data:[]}),a.mesagePagination.fetchData(r,t,(function(e){var t=Boolean(e.links.next);a.setState((function(){return{data:a.sortMessages(e.data),loading:!1,hasMore:!1,params:Sa({},r,{total:e.meta.total})}}),(function(){var e=a.scrollParent;void 0!==e&&(e.scrollTop=e.scrollHeight,a.setState({hasMore:t}),console.log("Showing Latest Messages"))}))}),(function(){a.setState({loading:!1})}))}})),Ma(ja(a),"sortMessages",(function(e){return Array.isArray(e)?(e=e.sort((function(e,t){return Object(i.d)(e.created_at,t.created_at)})),x()(e,"id")):e})),Ma(ja(a),"onLoadMore",(function(){if(a.canLoadMoreMessages()){var e=a.state,t=e.params,n=e.filters,r=Sa({},t,{current:t.current+1});a.mesagePagination.fetchData(r,n,(function(e){a.setState((function(t){var n=t.data;return{data:a.sortMessages(n.concat(e.data)),params:Sa({},r,{total:e.meta.total}),loadingMore:!1,hasMore:Boolean(e.links.next)}}))}),(function(){a.setState({loadingMore:!1})})),a.setState({loadingMore:!0})}})),Ma(ja(a),"getUserAvatar",(function(){var e=a.getHighlightedParticipant();return F()(e)?c.a.createElement(V.a,{icon:"message",size:40}):c.a.createElement(R.a,{showPresence:!1,user:e.user,size:40})})),Ma(ja(a),"onChangeText",(function(e){a.setState({text:e.target.value})})),Ma(ja(a),"handleTextKeyUp",(function(e){"Enter"===e.key&&a.sendText()})),Ma(ja(a),"toggleMarketplaceTradeDrawer",(function(){a.changeFullscreen(!1),a.setState((function(e){return{marketplaceTradeDrawerState:!e.marketplaceTradeDrawerState}}))})),Ma(ja(a),"setScrollWrapper",(function(e){if(e!==a.scrollWrapper&&null!==e){var t=new ce.a(e);a.scrollParent=t.getScrollElement(),a.scrollWrapper=e}})),Ma(ja(a),"getStatusColor",(function(e){switch(e){case"successful":return"#52c41a";case"active":return"#2db7f5";case"dispute":return"#faad14";case"cancelled":return"#f5222d";default:return null}})),a.broadcast=new K.a,a.api=new q.a,a.state={chat:{},loadingChat:!1,data:[],hasMore:!1,params:{total:0,pageSize:40,current:1},marketplaceTrade:{},marketplaceTradeDrawerState:!1,loading:!1,loadingMore:!1,text:"",sendingAttachment:!1,sendingText:!1},a}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ka(e,t)}(t,e),a=t,(n=[{key:"componentDidMount",value:function(){this.fetchChat()}},{key:"resetBroadcastChannel",value:function(){var e=this.state.chat;F()(e)?this.broadcast.unbind():this.broadcast.setChannel("App.Chat."+e.id)}},{key:"fetchMarketplaceTrade",value:function(){var e=this,t=this.state.chat;if(!F()(t)&&t.id){var a=this.api,n=a.axios,r=(0,a.route)("chats.latest-marketplace-trade",{chat:t.id});n.post(r.url()).then((function(t){return Object(H.d)(t,(function(t){e.setState({marketplaceTrade:t},(function(){e.scrollToBottom()}))}))})).catch((function(e){return Object(H.a)(e)}))}}},{key:"bindBroadcastEvents",value:function(){this.resetBroadcastChannel(),this.broadcast.listen("MarketplaceTradeSaved",this.marketplaceTradeSavedListener),this.broadcast.listen("NewChatMessage",this.newChatMessageListener)}},{key:"scrollToBottom",value:function(){var e=this.scrollParent;e&&(e.scrollTop=e.scrollHeight)}},{key:"canSendMessage",value:function(){return!F()(this.state.chat)&&!this.state.sendingAttachment&&!this.state.sendingText&&this.showMarketplaceTrades()}},{key:"canLoadMoreMessages",value:function(){var e=this.state,t=e.hasMore,a=e.loadingMore,n=e.loading;return t&&!a&&!n}},{key:"componentWillUnmount",value:function(){this.broadcast.unbind(),this.api.cancel()}},{key:"fetchChat",value:function(){var e=this,t=this.api,a=t.axios,n=t.route,r=this.props.activeChat;if(!F()(r)){var o=n("chats.get",{chat:r.token});a.post(o.url()).then((function(t){return Object(H.d)(t,(function(t){e.setState({loadingChat:!1,chat:t},(function(){e.fetchMessages(),e.fetchMarketplaceTrade(),e.updateParticipation(t.id),e.bindBroadcastEvents()}))}))})).catch((function(t){return Object(H.a)(t,(function(){e.setState({loadingChat:!1})}))})),this.setState({loadingChat:!0,chat:{}})}}},{key:"getHighlightedParticipant",value:function(){if(F()(this.highlightedParticpant)){var e=this.state.chat,t=this.props.auth,a=e.participants;this.highlightedParticpant=W()(a,(function(e){return!F()(e.user)&&e.user.id!==t.user.id}))}return this.highlightedParticpant}},{key:"getChatTitle",value:function(){var e=this.state.chat,t=this.getHighlightedParticipant(),a=e.participants;if(F()(t))return c.a.createElement(m.a,{defaultMessage:"You and {total} other(s)",id:"chats.default_title",values:{total:a.length}});var n=c.a.createElement(We.a,{to:"/profile/".concat(t.user.name)},t.user.name);return a.length>1?c.a.createElement(m.a,{defaultMessage:"{user} and {total} other(s)",id:"chats.view_title",values:{total:a.length-1,user:n}}):n}},{key:"changeFullscreen",value:function(e){var t=this.props.onChangeFullscreen;if("function"==typeof t)return t(e)}},{key:"showMarketplaceTrades",value:function(){var e=this.state.marketplaceTrade;return!F()(e)&&("active"===e.status||"dispute"===e.status)}},{key:"render",value:function(){var e=this,t=this.state,a=t.chat,n=t.data,o=t.text,i=t.marketplaceTrade,s=t.loadingChat,l=t.loading,u=t.loadingMore,f=t.hasMore,p=t.marketplaceTradeDrawerState,m=this.props,d=m.auth,h=m.intl,b=m.fullscreen,y=m.onToggleFullscreen,g=m.onToggleDrawer;if(F()(a))return s?c.a.createElement(oe.a,null):c.a.createElement(Le,{onToggleDrawer:g});var v=this.api.route("chats.messages.save-attachment",{chat:a.id});return c.a.createElement("div",{className:"cp-chat-main animated fadeIn"},c.a.createElement("div",{className:"cp-chat-main-header"},c.a.createElement("span",{className:"d-block d-lg-none cp-chat-btn"},c.a.createElement("i",{className:"cp-icon-btn la la-comments",onClick:g})),c.a.createElement("div",{className:"cp-chat-main-header-info"},c.a.createElement("div",{className:"cp-chat-avatar mr-2 d-none d-sm-block"},this.getUserAvatar()),c.a.createElement("div",{className:"cp-chat-contact-name"},this.getChatTitle())),this.showMarketplaceTrades()&&c.a.createElement(P.a,{onClick:this.toggleMarketplaceTradeDrawer,type:"dollar-circle",theme:"filled",className:"animated flash infinite slow mr-2 cp-fs-2x cp-icon-btn",style:{color:this.getStatusColor(i.status)}}),b?c.a.createElement("i",{className:"cp-icon-btn la la-compress ml-2 cp-fs-2x",onClick:y}):c.a.createElement("i",{className:"cp-icon-btn la la-expand ml-2 cp-fs-2x",onClick:y})),this.showMarketplaceTrades()&&c.a.createElement(r.a,{visible:p,closable:!1,width:320,onClose:this.toggleMarketplaceTradeDrawer,placement:"right"},c.a.createElement(ra,{onUpdate:this.onMarketplaceTradeUpdate,trade:i})),c.a.createElement(_.a,{spinning:l},c.a.createElement("div",{ref:this.setScrollWrapper,className:"cp-chat-list-scroll","data-simplebar":!0},c.a.createElement(ne.a,{useWindow:!1,loadMore:this.onLoadMore,getScrollParent:function(){return e.scrollParent},isReverse:!0,hasMore:!u&&f,pageStart:1,initialLoad:!1},u&&c.a.createElement(oe.a,null),c.a.createElement(I.a,{dataSource:n,rowKey:function(e){return e.id},renderItem:function(e){var t=e.user_id===d.user.id;switch(e.type){case"text":return c.a.createElement(Ye,{mode:t?"right":"left",message:e});case"attachment":return c.a.createElement(pt,{mode:t?"right":"left",message:e});case"activity":return c.a.createElement(rt,{message:e});default:return c.a.createElement(I.a.Item,null)}}}),c.a.createElement(ga,{trade:i})))),c.a.createElement("div",{className:"cp-chat-main-footer"},c.a.createElement(Oe.a,{gutter:8,className:"d-flex align-items-center"},c.a.createElement(Me.a,{xs:18,sm:20},c.a.createElement(Pa,{onKeyUp:this.handleTextKeyUp,placeholder:h.formatMessage(Ca.inputMessage),rows:2,value:o,disabled:!this.canSendMessage(),autoFocus:!0,style:{maxHeight:"48px",resize:"none"},onChange:this.onChangeText})),c.a.createElement(Me.a,{xs:6,sm:4},c.a.createElement(Oe.a,{gutter:4},c.a.createElement(Me.a,{span:12},c.a.createElement("div",{className:"cp-icon-btn"},c.a.createElement(je.a,{showUploadList:!1,beforeUpload:this.beforeUpload,action:v.url(),customRequest:q.c,onSuccess:this.handleUploadSuccess,onError:this.handleUploadError,withCredentials:!0},c.a.createElement("i",{className:"la la-paperclip cp-fs-2x"})))),c.a.createElement(Me.a,{span:12},c.a.createElement("i",{className:"cp-icon-btn la la-paper-plane cp-fs-2x",onClick:this.sendText})))))))}}])&&Oa(a.prototype,n),o&&Oa(a,o),t}(o.Component),Na=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),m.d)(Ta),xa=a("QprK"),Da=a.n(xa),Ua=a("TJpk");function Aa(e){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fa(e){return(Fa="function"==typeof Symbol&&"symbol"===Aa(Symbol.iterator)?function(e){return Aa(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Aa(e)})(e)}function Ba(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ia(e){return(Ia=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function La(e,t){return(La=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var za=Object(m.c)({pageTitle:{id:"meta.title.chat",defaultMessage:"Chat | {name}"}}),Va=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=Ia(t).call(this,e),a=!r||"object"!==Fa(r)&&"function"!=typeof r?Ra(n):r,Wa(Ra(a),"onToggleDrawer",(function(){a.setState((function(e){return{drawerState:!e.drawerState,fullscreen:!1}}))})),Wa(Ra(a),"onToggleFullscreen",(function(){a.setState((function(e){return{fullscreen:!e.fullscreen,drawerState:!1}}))})),Wa(Ra(a),"onChangeFullscreen",(function(e){a.setState({fullscreen:e})})),Wa(Ra(a),"getActiveChatParams",(function(){var e=a.props.location,t=Object(l.h)(e.pathname,{exact:!0,path:ie.a["chat.view"].path,strict:!1});return t&&t.params})),a.state={drawerState:!1,fullscreen:!1},a}var a,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&La(e,t)}(t,e),a=t,(n=[{key:"getPageTitle",value:function(){return this.props.intl.formatMessage(za.pageTitle,{name:Da.a.name})}},{key:"render",value:function(){var e=this.getActiveChatParams(),t=this.state,a=t.drawerState,n=t.fullscreen,o=c.a.createElement(we,{activeChat:e});return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ua.Helmet,null,c.a.createElement("title",null,this.getPageTitle())),c.a.createElement(S.a,{onChange:this.onChangeFullscreen,enabled:n},c.a.createElement("div",{className:"cp-app-module cp-chat-module"},c.a.createElement("div",{className:"cp-chat-module-box"},c.a.createElement("div",{className:"d-block d-lg-none"},c.a.createElement(r.a,{visible:a,closable:!1,onClose:this.onToggleDrawer,placement:"left"},o)),c.a.createElement("div",{className:"cp-chat-sidenav d-none d-lg-flex"},o),e?c.a.createElement(Na,{key:e.token,onChangeFullscreen:this.onChangeFullscreen,onToggleFullscreen:this.onToggleFullscreen,fullscreen:n,onToggleDrawer:this.onToggleDrawer,activeChat:e}):c.a.createElement(E,{onToggleDrawer:this.onToggleDrawer})))))}}])&&Ba(a.prototype,n),o&&Ba(a,o),t}(o.Component);t.default=Object(i.c)(Object(s.b)((function(e){var t=e.auth;return{auth:new u.a(t)}})),m.d,l.i)(Va)},wUfQ:function(e,t,a){"use strict";var n=a("o0o1"),r=a.n(n);function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(a,!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var s={base:1e3,precision:2,decimalSeparator:".",lowerCase:!1,space:!1,units:["","K","M","B","T","P","E"]},l=function(e){var t=parseFloat(e);if(Number.isNaN(t))throw new Error("Value must be a valid number");if(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)throw new RangeError("Value is either too big or too small");return t},u=r.a.mark((function e(t,a){var n,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a,o=0;case 2:if(!((c=t/n)<1)){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,{result:c,count:++o};case 8:n*=a,e.next=2;break;case 11:case"end":return e.stop()}}),e)})),f=function(e,t){if(!Number.isFinite(e))throw new Error("Value must be a finite number");if(!Number.isInteger(t)||t<0)throw new Error("Precision must be a non-negative integer");return Number.isInteger(e)?e:parseFloat(e.toFixed(t))};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=c({},s,{},t);if(!Array.isArray(a.units)||!a.units.length)throw new Error("Units must be an array");var n=l(e),r=n<0?"-":"";n=Math.abs(n);var o=0,i=!0,p=!1,m=void 0;try{for(var d,h=u(n,a.base)[Symbol.iterator]();!(i=(d=h.next()).done);i=!0){var b=d.value;n=b.result,o=b.count}}catch(e){p=!0,m=e}finally{try{i||null==h.return||h.return()}finally{if(p)throw m}}o=o>a.units.length?a.units.length-1:o;var y=a.lowerCase?a.units[o].toLowerCase():a.units[o],g=a.space?" ":"",v=f(n,a.precision),E=v.toString().replace(".",a.decimalSeparator);return"".concat(r).concat(E).concat(g).concat(y)}}};